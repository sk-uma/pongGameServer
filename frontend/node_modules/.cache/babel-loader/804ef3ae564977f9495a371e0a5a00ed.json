{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback } from \"react\";\nimport axios from \"axios\";\nimport { useLoginPlayer } from \"./useLoginPlayer\";\nimport { useMessage } from \"./useMessage\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst getToken = code => axios.post(\"https://api.intra.42.fr/oauth/token\", {\n  grant_type: \"authorization_code\",\n  client_id: \"5ec7a9808358afbd8a4a174c7d89d4ae27fc87b35477bf1065cc11387df68549\",\n  client_secret: \"811b6f2ae3b9ccb0fb01fe47113e2189280f6daa0a4ecadf082d3c1cd96670d6\",\n  code: code,\n  redirect_uri: \"http://localhost:3000/home\"\n});\n\nconst getMe = accessToken => axios.get(\"https://api.intra.42.fr/v2/me\", {\n  headers: {\n    Authorization: `Bearer ${accessToken}`\n  }\n});\n\nconst getPlayers = playerName => axios.get(`http://localhost:3001/players/${playerName}`);\n\nconst create42Player = (playerName, imgUrl) => axios.post(`http://localhost:3001/players`, {\n  name: playerName,\n  imgUrl: imgUrl,\n  password: \"42user\",\n  ftUser: true\n});\n\nexport const use42User = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const {\n    setLoginPlayer\n  } = useLoginPlayer();\n  const {\n    showMessage\n  } = useMessage();\n  const getFtUser = useCallback(code => {\n    if (code) {\n      getToken(code).then(tokenRes => {\n        getMe(tokenRes.data.access_token).then(Me => {\n          getPlayers(Me.data.login).then(res => {\n            setLoginPlayer(res.data);\n            showMessage({\n              title: \"42 Authorization Successful\",\n              status: \"success\"\n            });\n          }).catch(() => {\n            create42Player(Me.data.login, Me.data.image_url).then(res => {\n              setLoginPlayer(res.data);\n              showMessage({\n                title: \"42 Authorization Successful and Player Created\",\n                status: \"success\"\n              });\n            }).catch(() => console.log(\"Cannot create 42player\"));\n          });\n        }).catch(() => console.log(\"Not Found Me\"));\n      }).catch(() => console.log(\"Not Found AccessToken\"));\n    }\n  }, [setLoginPlayer]);\n  return {\n    getFtUser\n  };\n};\n\n_s(use42User, \"yrvxODcNW7PVrumgGhV2v7gGGr4=\", false, function () {\n  return [useNavigate, useLoginPlayer, useMessage];\n});","map":{"version":3,"sources":["/Users/r_tomishi/Desktop/42Tokyo/ft_transcendence/LocalDevelopment/frondend/src/hooks/use42User.ts"],"names":["useCallback","axios","useLoginPlayer","useMessage","useNavigate","getToken","code","post","grant_type","client_id","client_secret","redirect_uri","getMe","accessToken","get","headers","Authorization","getPlayers","playerName","create42Player","imgUrl","name","password","ftUser","use42User","navigate","setLoginPlayer","showMessage","getFtUser","then","tokenRes","data","access_token","Me","login","res","title","status","catch","image_url","console","log"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,OAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,QAA+B,kBAA/B;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,WAAT,QAA4B,kBAA5B;;AAEA,MAAMC,QAAQ,GAAIC,IAAD,IAChBL,KAAK,CAACM,IAAN,CAAW,qCAAX,EAAkD;AACjDC,EAAAA,UAAU,EAAE,oBADqC;AAEjDC,EAAAA,SAAS,EACR,kEAHgD;AAIjDC,EAAAA,aAAa,EACZ,kEALgD;AAMjDJ,EAAAA,IAAI,EAAEA,IAN2C;AAOjDK,EAAAA,YAAY,EAAE;AAPmC,CAAlD,CADD;;AAWA,MAAMC,KAAK,GAAIC,WAAD,IACbZ,KAAK,CAACa,GAAN,CAAU,+BAAV,EAA2C;AAC1CC,EAAAA,OAAO,EAAE;AACRC,IAAAA,aAAa,EAAG,UAASH,WAAY;AAD7B;AADiC,CAA3C,CADD;;AAOA,MAAMI,UAAU,GAAIC,UAAD,IAClBjB,KAAK,CAACa,GAAN,CAAW,iCAAgCI,UAAW,EAAtD,CADD;;AAGA,MAAMC,cAAc,GAAG,CAACD,UAAD,EAAqBE,MAArB,KACtBnB,KAAK,CAACM,IAAN,CAAY,+BAAZ,EAA4C;AAC3Cc,EAAAA,IAAI,EAAEH,UADqC;AAE3CE,EAAAA,MAAM,EAAEA,MAFmC;AAG3CE,EAAAA,QAAQ,EAAE,QAHiC;AAI3CC,EAAAA,MAAM,EAAE;AAJmC,CAA5C,CADD;;AAQA,OAAO,MAAMC,SAAS,GAAG,MAAM;AAAA;;AAC9B,QAAMC,QAAQ,GAAGrB,WAAW,EAA5B;AACA,QAAM;AAAEsB,IAAAA;AAAF,MAAqBxB,cAAc,EAAzC;AACA,QAAM;AAAEyB,IAAAA;AAAF,MAAkBxB,UAAU,EAAlC;AAEA,QAAMyB,SAAS,GAAG5B,WAAW,CAC3BM,IAAD,IAAyB;AACxB,QAAIA,IAAJ,EAAU;AACTD,MAAAA,QAAQ,CAACC,IAAD,CAAR,CACEuB,IADF,CACQC,QAAD,IAAc;AACnBlB,QAAAA,KAAK,CAACkB,QAAQ,CAACC,IAAT,CAAcC,YAAf,CAAL,CACEH,IADF,CACQI,EAAD,IAAQ;AACbhB,UAAAA,UAAU,CAACgB,EAAE,CAACF,IAAH,CAAQG,KAAT,CAAV,CACEL,IADF,CACQM,GAAD,IAAS;AACdT,YAAAA,cAAc,CAACS,GAAG,CAACJ,IAAL,CAAd;AACAJ,YAAAA,WAAW,CAAC;AACXS,cAAAA,KAAK,EAAE,6BADI;AAEXC,cAAAA,MAAM,EAAE;AAFG,aAAD,CAAX;AAIA,WAPF,EAQEC,KARF,CAQQ,MAAM;AACZnB,YAAAA,cAAc,CACbc,EAAE,CAACF,IAAH,CAAQG,KADK,EAEbD,EAAE,CAACF,IAAH,CAAQQ,SAFK,CAAd,CAIEV,IAJF,CAIQM,GAAD,IAAS;AACdT,cAAAA,cAAc,CAACS,GAAG,CAACJ,IAAL,CAAd;AACFJ,cAAAA,WAAW,CAAC;AACXS,gBAAAA,KAAK,EAAE,gDADI;AAEXC,gBAAAA,MAAM,EAAE;AAFG,eAAD,CAAX;AAIG,aAVH,EAWEC,KAXF,CAWQ,MACNE,OAAO,CAACC,GAAR,CACC,wBADD,CAZF;AAgBA,WAzBF;AA0BA,SA5BF,EA6BEH,KA7BF,CA6BQ,MAAME,OAAO,CAACC,GAAR,CAAY,cAAZ,CA7Bd;AA8BA,OAhCF,EAiCEH,KAjCF,CAiCQ,MAAME,OAAO,CAACC,GAAR,CAAY,uBAAZ,CAjCd;AAkCA;AACD,GAtC2B,EAuC5B,CAACf,cAAD,CAvC4B,CAA7B;AAyCA,SAAO;AAAEE,IAAAA;AAAF,GAAP;AACA,CA/CM;;GAAMJ,S;UACKpB,W,EACUF,c,EACHC,U","sourcesContent":["import { useCallback } from \"react\";\nimport axios from \"axios\";\nimport { useLoginPlayer } from \"./useLoginPlayer\";\nimport { useMessage } from \"./useMessage\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst getToken = (code: string) =>\n\taxios.post(\"https://api.intra.42.fr/oauth/token\", {\n\t\tgrant_type: \"authorization_code\",\n\t\tclient_id:\n\t\t\t\"5ec7a9808358afbd8a4a174c7d89d4ae27fc87b35477bf1065cc11387df68549\",\n\t\tclient_secret:\n\t\t\t\"811b6f2ae3b9ccb0fb01fe47113e2189280f6daa0a4ecadf082d3c1cd96670d6\",\n\t\tcode: code,\n\t\tredirect_uri: \"http://localhost:3000/home\",\n\t});\n\nconst getMe = (accessToken: string) =>\n\taxios.get(\"https://api.intra.42.fr/v2/me\", {\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t},\n\t});\n\nconst getPlayers = (playerName: string) =>\n\taxios.get(`http://localhost:3001/players/${playerName}`);\n\nconst create42Player = (playerName: string, imgUrl: string) =>\n\taxios.post(`http://localhost:3001/players`, {\n\t\tname: playerName,\n\t\timgUrl: imgUrl,\n\t\tpassword: \"42user\",\n\t\tftUser: true,\n\t});\n\nexport const use42User = () => {\n\tconst navigate = useNavigate();\n\tconst { setLoginPlayer } = useLoginPlayer();\n\tconst { showMessage } = useMessage();\n\n\tconst getFtUser = useCallback(\n\t\t(code: string | null) => {\n\t\t\tif (code) {\n\t\t\t\tgetToken(code)\n\t\t\t\t\t.then((tokenRes) => {\n\t\t\t\t\t\tgetMe(tokenRes.data.access_token)\n\t\t\t\t\t\t\t.then((Me) => {\n\t\t\t\t\t\t\t\tgetPlayers(Me.data.login)\n\t\t\t\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\t\t\t\tsetLoginPlayer(res.data);\n\t\t\t\t\t\t\t\t\t\tshowMessage({\n\t\t\t\t\t\t\t\t\t\t\ttitle: \"42 Authorization Successful\",\n\t\t\t\t\t\t\t\t\t\t\tstatus: \"success\",\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\t\t\tcreate42Player(\n\t\t\t\t\t\t\t\t\t\t\tMe.data.login,\n\t\t\t\t\t\t\t\t\t\t\tMe.data.image_url\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\t\t\t\t\t\tsetLoginPlayer(res.data)\n\t\t\t\t\t\t\t\t\t\tshowMessage({\n\t\t\t\t\t\t\t\t\t\t\ttitle: \"42 Authorization Successful and Player Created\",\n\t\t\t\t\t\t\t\t\t\t\tstatus: \"success\",\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)})\n\t\t\t\t\t\t\t\t\t\t\t.catch(() =>\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"Cannot create 42player\"\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(() => console.log(\"Not Found Me\"));\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => console.log(\"Not Found AccessToken\"));\n\t\t\t}\n\t\t},\n\t\t[setLoginPlayer]\n\t);\n\treturn { getFtUser };\n};\n"]},"metadata":{},"sourceType":"module"}